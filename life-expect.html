<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Life Expectancy â³ | AgeGuess</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <nav class="nav">
    <div class="nav-brand">AgeGuess ğŸ­</div>
    <div class="nav-links">
      <a href="index.html" data-en="Home" data-zh="é¦–é¡µ">Home</a>
      <a href="mental-age.html" data-en="Mental Age" data-zh="å¿ƒç†å¹´é¾„">Mental Age</a>
      <a href="face-age.html" data-en="Face Age" data-zh="é¢ç›¸å¹´é¾„">Face Age</a>
      <a href="life-expect.html" data-en="Life Expectancy" data-zh="å¯¿å‘½é¢„æµ‹">Life Expectancy</a>
      <a href="brain-age.html" data-en="Brain Age" data-zh="å¤§è„‘å¹´é¾„">Brain Age</a>
    </div>
    <button class="lang-btn" onclick="toggleLang()">ä¸­/EN</button>
  </nav>

  <div class="quiz-wrap">
    <div class="quiz-header">
      <h1 data-en="Life Expectancy Calculator â³" data-zh="å¯¿å‘½é¢„æµ‹è®¡ç®—å™¨ â³">Life Expectancy Calculator â³</h1>
      <p data-en="Estimate your lifespan based on lifestyle choices" data-zh="åŸºäºç”Ÿæ´»æ–¹å¼é€‰æ‹©ä¼°ç®—ä½ çš„å¯¿å‘½">Estimate your lifespan based on lifestyle choices</p>
    </div>

    <div class="progress-text"><span id="qnum">1</span>/12</div>
    <div class="progress-bar"><div class="progress-fill" id="progress"></div></div>

    <div id="quiz-container"></div>
    <div id="result-container" style="display:none"></div>
  </div>

  <div class="footer">
    <p data-en="Made with ğŸ’œ | For entertainment only!" data-zh="ç”¨å¿ƒåˆ¶ä½œ ğŸ’œ | ä»…ä¾›å¨±ä¹ï¼">Made with ğŸ’œ | For entertainment only!</p>
  </div>

  <script>
    let lang = localStorage.getItem('lang') || 'en';
    const questions = [
      {en: "Gender & starting age?", zh: "æ€§åˆ«å’Œèµ·å§‹å¹´é¾„ï¼Ÿ", opts: [{en:"Male",zh:"ç”·æ€§",base:76},{en:"Female",zh:"å¥³æ€§",base:81}]},
      {en: "Do you smoke?", zh: "ä½ å¸çƒŸå—ï¼Ÿ", opts: [{en:"Yes, daily",zh:"æ˜¯ï¼Œæ¯å¤©",v:-10},{en:"Occasionally",zh:"å¶å°”",v:-5},{en:"Former smoker",zh:"æ›¾ç»å¸çƒŸ",v:-2},{en:"Never",zh:"ä»ä¸",v:2}]},
      {en: "Exercise frequency?", zh: "è¿åŠ¨é¢‘ç‡ï¼Ÿ", opts: [{en:"Never",zh:"ä»ä¸",v:-4},{en:"1-2 times/week",zh:"æ¯å‘¨1-2æ¬¡",v:1},{en:"3-5 times/week",zh:"æ¯å‘¨3-5æ¬¡",v:3},{en:"Daily",zh:"æ¯å¤©",v:5}]},
      {en: "Diet quality?", zh: "é¥®é£Ÿè´¨é‡ï¼Ÿ", opts: [{en:"Mostly processed/fast food",zh:"ä¸»è¦æ˜¯åŠ å·¥/å¿«é¤",v:-3},{en:"Average",zh:"ä¸€èˆ¬",v:0},{en:"Balanced",zh:"å‡è¡¡",v:2},{en:"Mediterranean/plant-based",zh:"åœ°ä¸­æµ·/æ¤ç‰©æ€§",v:4}]},
      {en: "Alcohol consumption?", zh: "é¥®é…’é‡ï¼Ÿ", opts: [{en:"Heavy (>2 drinks/day)",zh:"å¤§é‡ï¼ˆæ¯å¤©>2æ¯ï¼‰",v:-5},{en:"Moderate (1-2/day)",zh:"é€‚é‡ï¼ˆæ¯å¤©1-2æ¯ï¼‰",v:1},{en:"Light (occasional)",zh:"å°‘é‡ï¼ˆå¶å°”ï¼‰",v:2},{en:"None",zh:"ä¸å–",v:1}]},
      {en: "Sleep quality?", zh: "ç¡çœ è´¨é‡ï¼Ÿ", opts: [{en:"Poor (<5h or >10h)",zh:"å·®ï¼ˆ<5hæˆ–>10hï¼‰",v:-3},{en:"Fair (5-6h)",zh:"ä¸€èˆ¬ï¼ˆ5-6hï¼‰",v:-1},{en:"Good (7-8h)",zh:"å¥½ï¼ˆ7-8hï¼‰",v:2},{en:"Excellent (consistent 7-8h)",zh:"æå¥½ï¼ˆç¨³å®š7-8hï¼‰",v:3}]},
      {en: "Stress levels?", zh: "å‹åŠ›æ°´å¹³ï¼Ÿ", opts: [{en:"Chronic high stress",zh:"é•¿æœŸé«˜å‹",v:-4},{en:"Moderate stress",zh:"ä¸­ç­‰å‹åŠ›",v:-1},{en:"Low stress",zh:"ä½å‹åŠ›",v:2},{en:"Very relaxed",zh:"éå¸¸æ”¾æ¾",v:3}]},
      {en: "Social connections?", zh: "ç¤¾äº¤è”ç³»ï¼Ÿ", opts: [{en:"Isolated/lonely",zh:"å­¤ç«‹/å­¤ç‹¬",v:-3},{en:"Few friends",zh:"æœ‹å‹å¾ˆå°‘",v:0},{en:"Good social circle",zh:"è‰¯å¥½ç¤¾äº¤åœˆ",v:2},{en:"Strong community ties",zh:"å¼ºå¤§ç¤¾ç¾¤è”ç³»",v:3}]},
      {en: "BMI/Weight status?", zh: "BMI/ä½“é‡çŠ¶å†µï¼Ÿ", opts: [{en:"Obese",zh:"è‚¥èƒ–",v:-5},{en:"Overweight",zh:"è¶…é‡",v:-2},{en:"Normal",zh:"æ­£å¸¸",v:2},{en:"Underweight",zh:"åç˜¦",v:-1}]},
      {en: "Chronic conditions?", zh: "æ…¢æ€§ç—…ï¼Ÿ", opts: [{en:"Multiple conditions",zh:"å¤šç§ç–¾ç—…",v:-8},{en:"One condition (managed)",zh:"ä¸€ç§ç–¾ç—…ï¼ˆæ§åˆ¶ä¸­ï¼‰",v:-3},{en:"None",zh:"æ²¡æœ‰",v:3}]},
      {en: "Mental health?", zh: "å¿ƒç†å¥åº·ï¼Ÿ", opts: [{en:"Depression/anxiety (untreated)",zh:"æŠ‘éƒ/ç„¦è™‘ï¼ˆæœªæ²»ç–—ï¼‰",v:-4},{en:"Some issues (managed)",zh:"ä¸€äº›é—®é¢˜ï¼ˆæ²»ç–—ä¸­ï¼‰",v:-1},{en:"Good",zh:"è‰¯å¥½",v:1},{en:"Excellent",zh:"æå¥½",v:3}]},
      {en: "Preventive care?", zh: "é¢„é˜²ä¿å¥ï¼Ÿ", opts: [{en:"Never see doctor",zh:"ä»ä¸çœ‹åŒ»ç”Ÿ",v:-3},{en:"Only when sick",zh:"åªåœ¨ç”Ÿç—…æ—¶",v:0},{en:"Annual checkups",zh:"å¹´åº¦ä½“æ£€",v:2},{en:"Proactive health monitoring",zh:"ä¸»åŠ¨å¥åº·ç›‘æµ‹",v:4}]}
    ];

    let currentQ = 0;
    let baseAge = 0;
    let lifeYears = 0;
    let currentAge = 0;
    let improvements = [];

    function showQuestion() {
      const q = questions[currentQ];
      const container = document.getElementById('quiz-container');
      
      if (currentQ === 0) {
        container.innerHTML = `
          <div class="question-card">
            <h2 data-en="What's your current age?" data-zh="ä½ ç°åœ¨å¤šå°‘å²ï¼Ÿ">What's your current age?</h2>
            <input type="number" id="current-age" min="13" max="100" placeholder="${lang === 'en' ? 'Enter age' : 'è¾“å…¥å¹´é¾„'}" style="width:100%; padding:1rem; font-size:1.1rem; background:rgba(255,255,255,0.05); border:1px solid rgba(255,255,255,0.2); border-radius:0.8rem; color:var(--text); margin-bottom:1.5rem;">
            <h2>${lang === 'en' ? q.en : q.zh}</h2>
            <div class="options">
              ${q.opts.map((opt, i) => `
                <button class="option-btn" onclick="answerFirst(${opt.base})">${lang === 'en' ? opt.en : opt.zh}</button>
              `).join('')}
            </div>
          </div>
        `;
        updateLang();
        return;
      }

      container.innerHTML = `
        <div class="question-card">
          <h2>${lang === 'en' ? q.en : q.zh}</h2>
          <div class="options">
            ${q.opts.map((opt, i) => `
              <button class="option-btn" onclick="answer(${opt.v}, '${opt.en}', ${i})">${lang === 'en' ? opt.en : opt.zh}</button>
            `).join('')}
          </div>
        </div>
      `;
      document.getElementById('qnum').textContent = currentQ + 1;
      document.getElementById('progress').style.width = ((currentQ / 12) * 100) + '%';
    }

    function answerFirst(base) {
      const ageInput = document.getElementById('current-age');
      currentAge = parseInt(ageInput.value);
      if (!currentAge || currentAge < 13 || currentAge > 100) {
        alert(lang === 'en' ? 'Please enter your age first (13-100)' : 'è¯·å…ˆè¾“å…¥ä½ çš„å¹´é¾„ï¼ˆ13-100ï¼‰');
        return;
      }
      baseAge = base;
      currentQ++;
      showQuestion();
    }

    function answer(value, optText, index) {
      lifeYears += value;
      
      // Track areas for improvement
      if (value < 0 && currentQ >= 1) {
        const qTexts = {
          1: {en: "Quit smoking", zh: "æˆ’çƒŸ"},
          2: {en: "Exercise more regularly", zh: "æ›´è§„å¾‹è¿åŠ¨"},
          3: {en: "Improve diet quality", zh: "æ”¹å–„é¥®é£Ÿè´¨é‡"},
          4: {en: "Moderate alcohol intake", zh: "é€‚åº¦é¥®é…’"},
          5: {en: "Improve sleep habits", zh: "æ”¹å–„ç¡çœ ä¹ æƒ¯"},
          6: {en: "Reduce stress levels", zh: "é™ä½å‹åŠ›æ°´å¹³"},
          7: {en: "Build social connections", zh: "å»ºç«‹ç¤¾äº¤è”ç³»"},
          8: {en: "Achieve healthy weight", zh: "è¾¾åˆ°å¥åº·ä½“é‡"},
          10: {en: "Prioritize mental health", zh: "é‡è§†å¿ƒç†å¥åº·"},
          11: {en: "Get regular checkups", zh: "å®šæœŸä½“æ£€"}
        };
        if (qTexts[currentQ]) improvements.push(qTexts[currentQ]);
      }
      
      currentQ++;
      if (currentQ < 12) {
        showQuestion();
      } else {
        showResult();
      }
    }

    function showResult() {
      const estimatedLife = Math.max(currentAge + 1, Math.min(110, baseAge + lifeYears));
      const yearsLeft = Math.max(0, estimatedLife - currentAge);
      
      document.getElementById('quiz-container').style.display = 'none';
      document.querySelector('.progress-bar').style.display = 'none';
      document.querySelector('.progress-text').style.display = 'none';
      
      const improvementList = improvements.length > 0 ? `
        <h3 style="margin:2rem 0 1rem; font-size:1.2rem;" data-en="ğŸ’¡ Top Improvements" data-zh="ğŸ’¡ æ”¹å–„å»ºè®®">ğŸ’¡ Top Improvements</h3>
        <ul class="tips-list">
          ${improvements.slice(0, 5).map(tip => `<li>${lang === 'en' ? tip.en : tip.zh}</li>`).join('')}
        </ul>
      ` : '';

      const resultHTML = `
        <div class="result-card">
          <div class="result-age">${estimatedLife}</div>
          <div class="result-label" data-en="Estimated Life Expectancy" data-zh="é¢„ä¼°å¯¿å‘½">Estimated Life Expectancy</div>
          <p class="result-desc" style="font-size:1.1rem; margin-bottom:0.5rem;">
            <span data-en="~${yearsLeft} years remaining" data-zh="~è¿˜å‰© ${yearsLeft} å¹´">~${yearsLeft} years remaining</span>
          </p>
          <p class="result-desc" style="font-size:0.85rem; color:var(--muted);" data-en="Based on current lifestyle choices. Small changes can add years!" data-zh="åŸºäºå½“å‰ç”Ÿæ´»æ–¹å¼ã€‚å°æ”¹å˜èƒ½å¢åŠ å¯¿å‘½ï¼">Based on current lifestyle choices. Small changes can add years!</p>
          ${improvementList}
          <div class="share-btns">
            <button class="btn btn-primary" onclick="share()" data-en="Share (Hide Number)" data-zh="åˆ†äº«ï¼ˆéšè—æ•°å­—ï¼‰">Share (Hide Number)</button>
            <button class="btn btn-outline" onclick="location.reload()" data-en="Retake Test" data-zh="é‡æ–°æµ‹è¯•">Retake Test</button>
            <button class="btn btn-outline" onclick="location.href='index.html'" data-en="More Tests" data-zh="æ›´å¤šæµ‹è¯•">More Tests</button>
          </div>
        </div>
      `;
      
      document.getElementById('result-container').innerHTML = resultHTML;
      document.getElementById('result-container').style.display = 'block';
      updateLang();
    }

    function share() {
      const text = lang === 'en' 
        ? `I just calculated my life expectancy! What's yours? Try AgeGuess â³` 
        : `æˆ‘åˆšæµ‹äº†æˆ‘çš„å¯¿å‘½é¢„æµ‹ï¼ä½ çš„å‘¢ï¼Ÿæ¥è¯•è¯• AgeGuess â³`;
      const url = window.location.href.split('?')[0];
      
      if (navigator.share) {
        navigator.share({ title: 'AgeGuess', text, url });
      } else {
        navigator.clipboard.writeText(text + '\n' + url);
        alert(lang === 'en' ? 'Link copied!' : 'é“¾æ¥å·²å¤åˆ¶ï¼');
      }
    }

    function toggleLang() {
      lang = lang === 'en' ? 'zh' : 'en';
      localStorage.setItem('lang', lang);
      updateLang();
      if (currentQ < 12) showQuestion();
    }

    function updateLang() {
      document.querySelectorAll('[data-en]').forEach(el => {
        const text = el.getAttribute('data-' + lang);
        if (el.tagName === 'INPUT') {
          el.placeholder = text;
        } else {
          el.textContent = text;
        }
      });
    }

    showQuestion();
    updateLang();
  </script>
</body>
</html>
